<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <link rel="icon" href="/favicon.ico" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Mini File Manager</title>
  <style>
    body {
      font-family: sans-serif;
    }

    #file-manager {
      height: 600px;
    }
  </style>
</head>

<body>
  <button id="pick-file">Pick File</button>
  <button id="destroy-fm">destroy file manager</button>
  <div id="file-manager"></div>
  <div id="file-manager1"></div>
  <script type="module">
    import { FileManager, FileManagerModal } from "./src/index.js";

    document.addEventListener("keyup", (e) => {
      if (e.code === "Tab") {
        document.body.classList.add("with-a11y");
      }
    });

    let appElt = document.getElementById("file-manager");
    let appElt1 = document.getElementById("file-manager1");

    let options = {
      endPoint: "http://mini-file-manager.local/media-manager",
      isAdmin: false,
      entryPoints: [
        {
          directory: "posts",
          origin: "public_uploads",
          readOnly: false,
          icon: "fa-lock",
          label: "Posts",
        },
        {
          directory: "posts/abc",
          origin: "public_uploads",
          readOnly: false,
          icon: "fa-lock",
          label: "Posts abc",
        },
      ],
      fileValidation: {
        mimeGroup: 'image',
        allowDir: false,
        imageOptions: {
          allowSvg: false,
          ratio: 1,
          // width: 1200,
          // height: 900,
        }
      },
      fileUpload: {
        // maxFileSize: 1024 * 1024
      },
      locale: "fr",
      multiple: true,
      // originalSelection: ["posts/image0.jpeg", "posts/image1.jpeg"]
    };

    let fileManager = FileManager(appElt, options);

    let filePicker = document.getElementById("pick-file");

    filePicker.addEventListener("click", e => {
      FileManagerModal(
        options,
        (files) => { console.log("onSuccess", files); },
        () => { console.log("onAbort"); }
      );
    });

    document.getElementById('destroy-fm').addEventListener('click', () => {
      if (fileManager) {
        fileManager.destroy();
        fileManager = null;
      }
    })
  </script>
</body>

</html>