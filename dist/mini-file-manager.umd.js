var __defProp=Object.defineProperty,__hasOwnProp=Object.prototype.hasOwnProperty,__getOwnPropSymbols=Object.getOwnPropertySymbols,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp=(e,t,n)=>t in e?__defProp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,__assign=(e,t)=>{for(var n in t||(t={}))__hasOwnProp.call(t,n)&&__defNormalProp(e,n,t[n]);if(__getOwnPropSymbols)for(var n of __getOwnPropSymbols(t))__propIsEnum.call(t,n)&&__defNormalProp(e,n,t[n]);return e};!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("vue")):"function"==typeof define&&define.amd?define(["exports","vue"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).miniFileManager={},e.Vue)}(this,(function(e,t){"use strict";
/*!
   * vuex v4.0.0
   * (c) 2021 Evan You
   * @license MIT
   */var n=("undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).__VUE_DEVTOOLS_GLOBAL_HOOK__;function i(e,t){Object.keys(e).forEach((function(n){return t(e[n],n)}))}function o(e){return null!==e&&"object"==typeof e}var r=function(e,t){this.runtime=t,this._children=Object.create(null),this._rawModule=e;var n=e.state;this.state=("function"==typeof n?n():n)||{}},s={namespaced:{configurable:!0}};s.namespaced.get=function(){return!!this._rawModule.namespaced},r.prototype.addChild=function(e,t){this._children[e]=t},r.prototype.removeChild=function(e){delete this._children[e]},r.prototype.getChild=function(e){return this._children[e]},r.prototype.hasChild=function(e){return e in this._children},r.prototype.update=function(e){this._rawModule.namespaced=e.namespaced,e.actions&&(this._rawModule.actions=e.actions),e.mutations&&(this._rawModule.mutations=e.mutations),e.getters&&(this._rawModule.getters=e.getters)},r.prototype.forEachChild=function(e){i(this._children,e)},r.prototype.forEachGetter=function(e){this._rawModule.getters&&i(this._rawModule.getters,e)},r.prototype.forEachAction=function(e){this._rawModule.actions&&i(this._rawModule.actions,e)},r.prototype.forEachMutation=function(e){this._rawModule.mutations&&i(this._rawModule.mutations,e)},Object.defineProperties(r.prototype,s);var l=function(e){this.register([],e,!1)};function a(e,t,n){if(t.update(n),n.modules)for(var i in n.modules){if(!t.getChild(i))return;a(e.concat(i),t.getChild(i),n.modules[i])}}l.prototype.get=function(e){return e.reduce((function(e,t){return e.getChild(t)}),this.root)},l.prototype.getNamespace=function(e){var t=this.root;return e.reduce((function(e,n){return e+((t=t.getChild(n)).namespaced?n+"/":"")}),"")},l.prototype.update=function(e){a([],this.root,e)},l.prototype.register=function(e,t,n){var o=this;void 0===n&&(n=!0);var s=new r(t,n);0===e.length?this.root=s:this.get(e.slice(0,-1)).addChild(e[e.length-1],s);t.modules&&i(t.modules,(function(t,i){o.register(e.concat(i),t,n)}))},l.prototype.unregister=function(e){var t=this.get(e.slice(0,-1)),n=e[e.length-1],i=t.getChild(n);i&&i.runtime&&t.removeChild(n)},l.prototype.isRegistered=function(e){var t=this.get(e.slice(0,-1)),n=e[e.length-1];return!!t&&t.hasChild(n)};var c=function(e){var t=this;void 0===e&&(e={});var i=e.plugins;void 0===i&&(i=[]);var o=e.strict;void 0===o&&(o=!1),this._committing=!1,this._actions=Object.create(null),this._actionSubscribers=[],this._mutations=Object.create(null),this._wrappedGetters=Object.create(null),this._modules=new l(e),this._modulesNamespaceMap=Object.create(null),this._subscribers=[],this._makeLocalGettersCache=Object.create(null);var r=this,s=this.dispatch,a=this.commit;this.dispatch=function(e,t){return s.call(r,e,t)},this.commit=function(e,t,n){return a.call(r,e,t,n)},this.strict=o;var c=this._modules.root.state;f(this,c,[],this._modules.root),h(this,c),i.forEach((function(e){return e(t)})),(void 0===e.devtools||e.devtools)&&function(e){n&&(e._devtoolHook=n,n.emit("vuex:init",e),n.on("vuex:travel-to-state",(function(t){e.replaceState(t)})),e.subscribe((function(e,t){n.emit("vuex:mutation",e,t)}),{prepend:!0}),e.subscribeAction((function(e,t){n.emit("vuex:action",e,t)}),{prepend:!0}))}(this)},d={state:{configurable:!0}};function u(e,t,n){return t.indexOf(e)<0&&(n&&n.prepend?t.unshift(e):t.push(e)),function(){var n=t.indexOf(e);n>-1&&t.splice(n,1)}}function p(e,t){e._actions=Object.create(null),e._mutations=Object.create(null),e._wrappedGetters=Object.create(null),e._modulesNamespaceMap=Object.create(null);var n=e.state;f(e,n,[],e._modules.root,!0),h(e,n,t)}function h(e,n,o){var r=e._state;e.getters={},e._makeLocalGettersCache=Object.create(null);var s=e._wrappedGetters,l={};i(s,(function(t,n){l[n]=function(e,t){return function(){return e(t)}}(t,e),Object.defineProperty(e.getters,n,{get:function(){return l[n]()},enumerable:!0})})),e._state=t.reactive({data:n}),e.strict&&function(e){t.watch((function(){return e._state.data}),(function(){}),{deep:!0,flush:"sync"})}(e),r&&o&&e._withCommit((function(){r.data=null}))}function f(e,t,n,i,o){var r=!n.length,s=e._modules.getNamespace(n);if(i.namespaced&&(e._modulesNamespaceMap[s],e._modulesNamespaceMap[s]=i),!r&&!o){var l=m(t,n.slice(0,-1)),a=n[n.length-1];e._withCommit((function(){l[a]=i.state}))}var c=i.context=function(e,t,n){var i=""===t,o={dispatch:i?e.dispatch:function(n,i,o){var r=y(n,i,o),s=r.payload,l=r.options,a=r.type;return l&&l.root||(a=t+a),e.dispatch(a,s)},commit:i?e.commit:function(n,i,o){var r=y(n,i,o),s=r.payload,l=r.options,a=r.type;l&&l.root||(a=t+a),e.commit(a,s,l)}};return Object.defineProperties(o,{getters:{get:i?function(){return e.getters}:function(){return function(e,t){if(!e._makeLocalGettersCache[t]){var n={},i=t.length;Object.keys(e.getters).forEach((function(o){if(o.slice(0,i)===t){var r=o.slice(i);Object.defineProperty(n,r,{get:function(){return e.getters[o]},enumerable:!0})}})),e._makeLocalGettersCache[t]=n}return e._makeLocalGettersCache[t]}(e,t)}},state:{get:function(){return m(e.state,n)}}}),o}(e,s,n);i.forEachMutation((function(t,n){!function(e,t,n,i){(e._mutations[t]||(e._mutations[t]=[])).push((function(t){n.call(e,i.state,t)}))}(e,s+n,t,c)})),i.forEachAction((function(t,n){var i=t.root?n:s+n,o=t.handler||t;!function(e,t,n,i){(e._actions[t]||(e._actions[t]=[])).push((function(t){var o,r=n.call(e,{dispatch:i.dispatch,commit:i.commit,getters:i.getters,state:i.state,rootGetters:e.getters,rootState:e.state},t);return(o=r)&&"function"==typeof o.then||(r=Promise.resolve(r)),e._devtoolHook?r.catch((function(t){throw e._devtoolHook.emit("vuex:error",t),t})):r}))}(e,i,o,c)})),i.forEachGetter((function(t,n){!function(e,t,n,i){if(e._wrappedGetters[t])return;e._wrappedGetters[t]=function(e){return n(i.state,i.getters,e.state,e.getters)}}(e,s+n,t,c)})),i.forEachChild((function(i,r){f(e,t,n.concat(r),i,o)}))}function m(e,t){return t.reduce((function(e,t){return e[t]}),e)}function y(e,t,n){return o(e)&&e.type&&(n=t,t=e,e=e.type),{type:e,payload:t,options:n}}c.prototype.install=function(e,t){e.provide(t||"store",this),e.config.globalProperties.$store=this},d.state.get=function(){return this._state.data},d.state.set=function(e){},c.prototype.commit=function(e,t,n){var i=this,o=y(e,t,n),r=o.type,s=o.payload,l={type:r,payload:s},a=this._mutations[r];a&&(this._withCommit((function(){a.forEach((function(e){e(s)}))})),this._subscribers.slice().forEach((function(e){return e(l,i.state)})))},c.prototype.dispatch=function(e,t){var n=this,i=y(e,t),o=i.type,r=i.payload,s={type:o,payload:r},l=this._actions[o];if(l){try{this._actionSubscribers.slice().filter((function(e){return e.before})).forEach((function(e){return e.before(s,n.state)}))}catch(c){}var a=l.length>1?Promise.all(l.map((function(e){return e(r)}))):l[0](r);return new Promise((function(e,t){a.then((function(t){try{n._actionSubscribers.filter((function(e){return e.after})).forEach((function(e){return e.after(s,n.state)}))}catch(c){}e(t)}),(function(e){try{n._actionSubscribers.filter((function(e){return e.error})).forEach((function(t){return t.error(s,n.state,e)}))}catch(c){}t(e)}))}))}},c.prototype.subscribe=function(e,t){return u(e,this._subscribers,t)},c.prototype.subscribeAction=function(e,t){return u("function"==typeof e?{before:e}:e,this._actionSubscribers,t)},c.prototype.watch=function(e,n,i){var o=this;return t.watch((function(){return e(o.state,o.getters)}),n,Object.assign({},i))},c.prototype.replaceState=function(e){var t=this;this._withCommit((function(){t._state.data=e}))},c.prototype.registerModule=function(e,t,n){void 0===n&&(n={}),"string"==typeof e&&(e=[e]),this._modules.register(e,t),f(this,this.state,e,this._modules.get(e),n.preserveState),h(this,this.state)},c.prototype.unregisterModule=function(e){var t=this;"string"==typeof e&&(e=[e]),this._modules.unregister(e),this._withCommit((function(){delete m(t.state,e.slice(0,-1))[e[e.length-1]]})),p(this)},c.prototype.hasModule=function(e){return"string"==typeof e&&(e=[e]),this._modules.isRegistered(e)},c.prototype.hotUpdate=function(e){this._modules.update(e),p(this,!0)},c.prototype._withCommit=function(e){var t=this._committing;this._committing=!0,e(),this._committing=t},Object.defineProperties(c.prototype,d);var g=_((function(e,t){var n={};return w(t).forEach((function(t){var i=t.key,o=t.val;n[i]=function(){var t=this.$store.state,n=this.$store.getters;if(e){var i=C(this.$store,"mapState",e);if(!i)return;t=i.context.state,n=i.context.getters}return"function"==typeof o?o.call(this,t,n):t[o]},n[i].vuex=!0})),n})),v=_((function(e,t){var n={};return w(t).forEach((function(t){var i=t.key,o=t.val;n[i]=function(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];var i=this.$store.commit;if(e){var r=C(this.$store,"mapMutations",e);if(!r)return;i=r.context.commit}return"function"==typeof o?o.apply(this,[i].concat(t)):i.apply(this.$store,[o].concat(t))}})),n})),b=_((function(e,t){var n={};return w(t).forEach((function(t){var i=t.key,o=t.val;o=e+o,n[i]=function(){if(!e||C(this.$store,"mapGetters",e))return this.$store.getters[o]},n[i].vuex=!0})),n})),k=_((function(e,t){var n={};return w(t).forEach((function(t){var i=t.key,o=t.val;n[i]=function(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];var i=this.$store.dispatch;if(e){var r=C(this.$store,"mapActions",e);if(!r)return;i=r.context.dispatch}return"function"==typeof o?o.apply(this,[i].concat(t)):i.apply(this.$store,[o].concat(t))}})),n}));function w(e){return function(e){return Array.isArray(e)||o(e)}(e)?Array.isArray(e)?e.map((function(e){return{key:e,val:e}})):Object.keys(e).map((function(t){return{key:t,val:e[t]}})):[]}function _(e){return function(t,n){return"string"!=typeof t?(n=t,t=""):"/"!==t.charAt(t.length-1)&&(t+="/"),e(t,n)}}function C(e,t,n){return e._modulesNamespaceMap[n]}const F="pentatrion-notify",N="pentatrion-notify__cross",S=function(e,t){let n=document.createElement("DIV"),i=document.createElement("DIV"),o=t.style,r=document.createElementNS("http://www.w3.org/2000/svg","svg");return r.innerHTML='<path fill="currentColor" d="M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"></path>',r.setAttribute("viewBox","0 0 352 512"),r.setAttribute("height",15),i.append(r),n.classList.add(F),o&&n.classList.add(F+"--"+o),n.innerHTML=e,i.classList.add(N),i.addEventListener("click",n.remove.bind(n)),n.appendChild(i),n},D="pentatrion-notify--bounce-in";let E=[];function V(e=document.body){if(e.dataset.miniNotifier)return E[+e.dataset.miniNotifier];let t=function(){let e=document.createElement("DIV");return e.classList.add("pentatrion-notifies"),e}();e===document.body&&t.classList.add("fixed");let n=E.push(t);return e.dataset.miniNotifier=n-1,e.appendChild(t),t}function B(e="",t={}){let n=V(t.target);const i=t.time||5e3;let o=S(e,t);window.setTimeout((function(){o.remove()}),i),n.appendChild(o),o.classList.add(D)}const P={data:()=>({sending:!1,uploadedFiles:0,filesToUpload:0,dropActive:!1,progressFilename:null,progressNumber:0}),computed:__assign(__assign(__assign({},g(["endPoints","currentEntryPoint","isAdmin"])),b(["completeDirectory"])),{canUpload(){return this.isAdmin||!this.currentEntryPoint.readOnly}}),methods:__assign(__assign({},v(["addFile","setFiles"])),{reset(){this.sending=!1,this.uploadedFiles=0,this.filesToUpload=0,this.progressNumber=0,this.progressFilename=null},highlight(){this.dropActive=!0},unhighlight(){this.dropActive=!1},handleDrop(e){this.unhighlight();let t=e.dataTransfer.files;this.handleFiles(t)},handleChange(e){let t=e.currentTarget.files;this.handleFiles(t)},async handleFiles(e){if(0!==e.length){this.filesToUpload=e.length,this.sending=!0;for(let t of e)await this.uploadFile(t)}},uploadFile(e){let t=this;return new Promise((n=>{let i=new FormData;i.append("file",e),i.append("directory",this.completeDirectory),i.append("origin",this.currentEntryPoint.origin),i.append("fileManager",!0),this.progressFilename=e.name,this.progressNumber=0;let o=new XMLHttpRequest;o.upload.onprogress=function(e){e.lengthComputable&&(t.progressNumber=Math.round(100*e.loaded/e.total))},o.open("POST",this.endPoints.uploadFile),o.onload=function(){let e;t.progressNumber=100;try{e=JSON.parse(this.responseText),200===this.status&&e&&e.files?t.setFiles(e.files):B(e.title||e,{style:"error"})}catch(i){return void B(this.responseText,{style:"error"})}finally{t.uploadedFiles++,t.checkFinished(),n()}},o.onerror=function(e){B(e.target.statusText,{style:"error"}),t.uploadedFiles++,t.checkFinished(),n()},o.send(i)}))},checkFinished(){this.uploadedFiles<this.filesToUpload||this.reset()}})},O=t.withScopeId("data-v-2056ba30");t.pushScopeId("data-v-2056ba30");const T={key:0},L={key:0,class:"label",for:"fileElem"},M=t.createVNode("span",null,[t.createVNode("i",{class:"fa-doc-add"}),t.createTextVNode("Ajouter")],-1),x={key:1},I={class:"filename"},A={class:"counter ref"},j={key:1,class:"drop-area readonly"},$=t.createVNode("label",{class:"label"}," Répertoire en lecture seule. ",-1);t.popScopeId();const U=O(((e,n,i,o,r,s)=>e.completeDirectory?(t.openBlock(),t.createBlock("div",T,[s.canUpload?(t.openBlock(),t.createBlock("div",{key:0,class:["drop-area",{highlight:r.dropActive,sending:r.sending}],onDragenter:n[2]||(n[2]=t.withModifiers(((...e)=>s.highlight&&s.highlight(...e)),["prevent","stop"])),onDragover:n[3]||(n[3]=t.withModifiers(((...e)=>s.highlight&&s.highlight(...e)),["prevent","stop"])),onDragleave:n[4]||(n[4]=t.withModifiers(((...e)=>s.unhighlight&&s.unhighlight(...e)),["prevent","stop"])),onDrop:n[5]||(n[5]=t.withModifiers(((...e)=>s.handleDrop&&s.handleDrop(...e)),["prevent","stop"]))},[t.createVNode("input",{type:"file",name:"upload",multiple:"",id:"fileElem",disabled:r.sending,accept:"image/*,text/*,video/*,audio/*,.rtf,.pdf,.xml,font/*,.ods,.odt,.docx,.doc,.xlsx,.xls,.json,.ai,.zip",onChange:n[1]||(n[1]=(...e)=>s.handleChange&&s.handleChange(...e))},null,40,["disabled"]),r.sending?r.progressFilename?(t.openBlock(),t.createBlock("div",x,[t.createVNode("div",{class:"progress-value",style:{width:r.progressNumber+"%"}},null,4),t.createVNode("div",I,t.toDisplayString(r.progressFilename),1),t.createVNode("div",A,t.toDisplayString(r.uploadedFiles+1)+" / "+t.toDisplayString(r.filesToUpload),1)])):t.createCommentVNode("",!0):(t.openBlock(),t.createBlock("label",L,[M]))],34)):(t.openBlock(),t.createBlock("div",j,[$]))])):t.createCommentVNode("",!0)));P.render=U,P.__scopeId="data-v-2056ba30";const R={props:["files"],data:()=>({filename:"",ext:""}),computed:__assign(__assign({},g(["urlUploadFile","directory","editing","isAdmin","currentEntryPoint","endPoints","secondaryDirectories"])),{currentDirectoryName(){return this.secondaryDirectories.length>0?this.secondaryDirectories[this.secondaryDirectories.length-1]:this.currentEntryPoint.label},file(){return 1===this.files.length?this.files[0]:null}}),watch:{files(e){if(1===e.length){let t=e[0].filename,n=t.lastIndexOf(".");-1===n?(this.filename=t,this.ext=""):(this.filename=t.substring(0,n),this.ext=t.substring(n))}}},methods:__assign(__assign(__assign({},k(["updateFilename","download","deleteSelectedFiles"])),v(["setEditing"])),{formatDate(e){let t=new Date(e);return t instanceof Date&&!isNaN(t)?new Intl.DateTimeFormat("fr-FR").format(t):""},canEdit(e){return!!this.isAdmin||!this.currentEntryPoint.readOnly&&!e.readOnly},copyToClipboard(){this.$refs.inputUrl.select(),document.execCommand("copy"),B("URL copiée")},editFilename(){let e=this.filename+this.ext;this.editing?this.filename&&"."!==this.filename[0]?e!==this.file.filename&&this.updateFilename({file:this.file,filename:e}):B("Nom de fichier non valide.",{style:"error"}):setTimeout((()=>{this.$refs.inputFilename.select()}),100),this.setEditing(!this.editing)},handleOpen(){this.file.url?window.open(this.file.url,"_blank"):window.open(`${window.location.origin}${this.endPoints.showFile}/show/${this.file.origin}/${this.file.uploadRelativePath}`,"_blank")},handleDownload(){let e=0===this.files.length?[this.directory]:this.files;this.download({files:e})}})},H=t.withScopeId("data-v-813ef8ae");t.pushScopeId("data-v-813ef8ae");const G={key:0,class:"infos"},z={key:0},q={class:"form-group"},X=t.createVNode("label",null,"Nom du dossier",-1),K={class:"form-group"},W=t.createVNode("label",null,"Accès",-1),Y={key:0},J=t.createVNode("div",null,"Public",-1),Q={key:1},Z=t.createVNode("div",null,"Protégé",-1),ee={class:"form-group"},te=t.createVNode("label",null,"Télécharger tout le dossier",-1),ne=t.createVNode("i",{class:"fa-download"},null,-1),ie={key:1},oe={for:"name"},re=t.createTextVNode(" Nom "),se={key:0,class:"fa-ok"},le={key:1,class:"fa-pencil"},ae={key:0},ce={key:1},de={key:0,class:"input-with-button edit-filename"},ue={class:"form-group compact"},pe=t.createVNode("label",null,"Accès",-1),he={key:0},fe={key:1},me={class:"form-group compact"},ye=t.createVNode("label",null,"Ajouté le",-1),ge={class:"form-group compact"},ve=t.createVNode("label",null,"Taille",-1),be={key:0,class:"form-group compact"},ke=t.createVNode("label",null,"URL",-1),we={class:"file-url input-with-button"},_e=t.createVNode("i",{class:"fa-clipboard"},null,-1),Ce={class:"form-group btns"},Fe=t.createVNode("i",{class:"fa-trash"},null,-1),Ne=t.createVNode("i",{class:"fa-eye"},null,-1),Se=t.createVNode("i",{class:"fa-download"},null,-1),De={key:2};t.popScopeId();const Ee=H(((e,n,i,o,r,s)=>e.directory?(t.openBlock(),t.createBlock("div",G,[0===i.files.length?(t.openBlock(),t.createBlock("div",z,[t.createVNode("div",q,[X,t.createVNode("div",null,t.toDisplayString(e.directory.filename),1)]),t.createVNode("div",K,[W,e.currentEntryPoint.url?(t.openBlock(),t.createBlock("div",Y,[J])):(t.openBlock(),t.createBlock("div",Q,[Z]))]),t.createVNode("div",ee,[te,t.createVNode("button",{class:"btn",onClick:n[1]||(n[1]=t.withModifiers(((...e)=>s.handleDownload&&s.handleDownload(...e)),["prevent"]))},[ne])])])):1===i.files.length?(t.openBlock(),t.createBlock("div",ie,[t.createVNode("form",{onSubmit:n[5]||(n[5]=t.withModifiers(((...e)=>s.editFilename&&s.editFilename(...e)),["prevent"])),class:"form-group filename"},[t.createVNode("label",oe,[re,s.canEdit(s.file)?(t.openBlock(),t.createBlock("button",{key:0,href:"#",class:"with-icon btn-factice",onClick:n[2]||(n[2]=t.withModifiers(((...e)=>s.editFilename&&s.editFilename(...e)),["prevent"]))},[e.editing?(t.openBlock(),t.createBlock("i",se)):(t.openBlock(),t.createBlock("i",le))])):t.createCommentVNode("",!0)]),s.canEdit(s.file)?(t.openBlock(),t.createBlock("div",ce,[e.editing?(t.openBlock(),t.createBlock("div",de,[t.withDirectives(t.createVNode("input",{type:"text",size:"1",class:"input-filename",ref:"inputFilename","onUpdate:modelValue":n[3]||(n[3]=t=>e.filename=t)},null,512),[[t.vModelText,e.filename]]),t.createVNode("span",null,t.toDisplayString(e.ext),1)])):(t.openBlock(),t.createBlock("div",{key:1,class:"div-filename",onClick:n[4]||(n[4]=t.withModifiers(((...e)=>s.editFilename&&s.editFilename(...e)),["prevent"]))},t.toDisplayString(s.file.filename),1))])):(t.openBlock(),t.createBlock("div",ae,[t.createVNode("div",null,t.toDisplayString(s.file.filename),1)]))],32),t.createVNode("div",ue,[pe,s.canEdit(s.file)?(t.openBlock(),t.createBlock("div",he,"Lecture et modification")):(t.openBlock(),t.createBlock("div",fe,"Lecture seule"))]),t.createVNode("div",me,[ye,t.createVNode("div",null,t.toDisplayString(s.formatDate(s.file.createdAt)),1)]),t.createVNode("div",ge,[ve,t.createVNode("div",null,t.toDisplayString(s.file.humanSize),1)]),s.file.url?(t.openBlock(),t.createBlock("div",be,[ke,t.createVNode("div",we,[t.createVNode("input",{size:"1",class:"form-input",ref:"inputUrl",onFocus:n[6]||(n[6]=e=>e.target.select()),type:"text",readOnly:"",value:s.file.url},null,40,["value"]),t.createVNode("a",{href:"#",onClick:n[7]||(n[7]=t.withModifiers(((...e)=>s.copyToClipboard&&s.copyToClipboard(...e)),["prevent"])),class:"btn outlined btn-factice"},[_e])])])):t.createCommentVNode("",!0),t.createVNode("div",Ce,[s.canEdit(s.file)?(t.openBlock(),t.createBlock("button",{key:0,class:"btn btn-outlined",onClick:n[8]||(n[8]=t.withModifiers(((...t)=>e.deleteSelectedFiles&&e.deleteSelectedFiles(...t)),["prevent"]))},[Fe])):t.createCommentVNode("",!0),s.file&&!s.file.isDir?(t.openBlock(),t.createBlock("button",{key:1,class:"btn btn-outlined",onClick:n[9]||(n[9]=t.withModifiers(((...e)=>s.handleOpen&&s.handleOpen(...e)),["prevent"]))},[Ne])):t.createCommentVNode("",!0),t.createVNode("button",{class:"btn",onClick:n[10]||(n[10]=t.withModifiers(((...e)=>s.handleDownload&&s.handleDownload(...e)),["prevent"]))},[Se])])])):i.files.length>1?(t.openBlock(),t.createBlock("div",De,t.toDisplayString(i.files.length)+" éléments sélectionnés ",1)):t.createCommentVNode("",!0)])):t.createCommentVNode("",!0)));R.render=Ee,R.__scopeId="data-v-813ef8ae";const Ve={props:["options","placeholder","value","splitButton"],data:()=>({isOpen:!1,focusListener:null}),computed:{spinnerClass(){return this.isOpen?"fa-up-open":"fa-down-open"},valueLabel(){return this.value?this.value.label:this.placeholder}},methods:{handleClickOption(e){this.isOpen=!1,this.$emit("input",e)},handleClickSelect(e){this.splitButton?this.$emit("click",this.value):this.isOpen=!this.isOpen},handleClickContainer(e){this.isOpen=!1},handleClickSplit(e){this.isOpen=!this.isOpen}}},Be=t.withScopeId("data-v-18e65654");t.pushScopeId("data-v-18e65654");const Pe={key:0},Oe={key:1,class:"select-items"},Te={key:0};t.popScopeId();const Le=Be(((e,n,i,o,r,s)=>(t.openBlock(),t.createBlock("div",{class:["custom-select",{"is-open":e.isOpen,"with-split-button":i.splitButton&&i.options.length>1}],onClick:n[3]||(n[3]=(...e)=>s.handleClickContainer&&s.handleClickContainer(...e))},[t.createVNode("a",{href:"#",class:"   select-selected",tabindex:"0",onClick:n[1]||(n[1]=t.withModifiers(((...e)=>s.handleClickSelect&&s.handleClickSelect(...e)),["stop","prevent"]))},[i.value&&i.value.icon?(t.openBlock(),t.createBlock("span",Pe,[t.createVNode("i",{class:i.value.icon},null,2)])):t.createCommentVNode("",!0),t.createTextVNode(" "+t.toDisplayString(s.valueLabel),1)]),i.splitButton&&i.options.length>1?(t.openBlock(),t.createBlock("a",{key:0,href:"#",tabindex:"0",class:"split-button",onClick:n[2]||(n[2]=t.withModifiers(((...e)=>s.handleClickSplit&&s.handleClickSplit(...e)),["stop","prevent"]))},[t.createVNode("i",{class:s.spinnerClass},null,2)])):t.createCommentVNode("",!0),e.isOpen?(t.openBlock(),t.createBlock("div",Oe,[(t.openBlock(!0),t.createBlock(t.Fragment,null,t.renderList(i.options,(e=>(t.openBlock(),t.createBlock("a",{href:"#",onClick:t.withModifiers((t=>s.handleClickOption(e)),["stop","prevent"]),key:e.value,class:"select-item"},[e.icon?(t.openBlock(),t.createBlock("span",Te,[t.createVNode("i",{class:e.icon},null,2)])):t.createCommentVNode("",!0),t.createTextVNode(" "+t.toDisplayString(e.label),1)],8,["onClick"])))),128))])):t.createCommentVNode("",!0)],2))));Ve.render=Le,Ve.__scopeId="data-v-18e65654";const Me={props:["file"],methods:{formatDate(e){let t=new Date(e);return t instanceof Date&&!isNaN(t)?new Intl.DateTimeFormat("fr-FR").format(t):""}}},xe=t.withScopeId("data-v-91ad3fe8");t.pushScopeId("data-v-91ad3fe8");const Ie={class:"filename"},Ae={class:"size ref"},je={class:"date ref"};t.popScopeId();const $e=xe(((e,n,i,o,r,s)=>(t.openBlock(),t.createBlock("a",{href:"#",class:"file",onClick:n[1]||(n[1]=t.withModifiers((t=>e.$emit("click",t)),["prevent"])),onDblclick:n[2]||(n[2]=t=>e.$emit("dblclick",t))},[t.createVNode("div",Ie,t.toDisplayString(i.file.filename),1),t.createVNode("div",Ae,t.toDisplayString(i.file.humanSize),1),t.createVNode("div",je,t.toDisplayString(s.formatDate(i.file.createdAt)),1)],32))));Me.render=$e,Me.__scopeId="data-v-91ad3fe8";const Ue={props:["file"],computed:{},methods:{iconPath(e){var t;return(null==(t=e.thumbnails)?void 0:t.small)?e.thumbnails.small:e.icon},isIcon(e){var t;return!(null==(t=e.thumbnails)?void 0:t.small)},handleDragStart(e,t){t.url&&(e.dataTransfer.setData("text/html",`<img src="${t.url}">`),e.dataTransfer.setData("text/plain",t.url),e.dataTransfer.setData("application/x-editor-js",t.url))}}},Re=t.withScopeId("data-v-007f00e7");t.pushScopeId("data-v-007f00e7");const He={class:"square"},Ge={class:"filename"};t.popScopeId();const ze=Re(((e,n,i,o,r,s)=>(t.openBlock(),t.createBlock("a",{href:"#",class:"file",onClick:n[2]||(n[2]=t.withModifiers((t=>e.$emit("click",t)),["prevent"])),onDblclick:n[3]||(n[3]=t=>e.$emit("dblclick",t))},[t.createVNode("div",He,[t.createVNode("div",{class:["img-container",{"is-icon":s.isIcon(i.file),"is-not-icon":!s.isIcon(i.file)}]},[t.createVNode("img",{onDragstart:n[1]||(n[1]=e=>s.handleDragStart(e,i.file)),alt:i.file.filename,src:s.iconPath(i.file)},null,40,["alt","src"])],2)]),t.createVNode("div",Ge,t.toDisplayString(i.file.label||i.file.filename),1)],32))));Ue.render=ze,Ue.__scopeId="data-v-007f00e7";const qe={components:{Uploader:P,Infos:R,VSelect:Ve,Icon:Ue,ListItem:Me},props:{isModal:{type:Boolean,default:!1}},data:()=>({presentation:"icons",options:{}}),computed:__assign(__assign({},g(["editing","files","selectedFiles","entryPoints","secondaryDirectories","currentEntryPoint","isAdmin"])),{canEdit(){return!!this.isAdmin||this.currentEntryPoint&&!this.currentEntryPoint.readOnly},currentEntryPoint:{get(){return this.$store.state.currentEntryPoint},set(e){this.$store.dispatch("setCurrentEntryPoint",e)}},fileComponent(){return"list"===this.presentation?Me:Ue},presentationClass(){return`${this.presentation}-presentation`}}),methods:__assign(__assign(__assign({},v(["selectFile","unselectFiles","addFileToSelection","removeFileToSelection"])),k(["init","setCurrentEntryPoint","download","deleteSelectedFiles","setSecondaryDirectoryFromFullDirectory","addDirectory"])),{toggleOrder(){this.presentation="list"===this.presentation?"icons":"list"},noDragging(e){e.dataTransfer.dropEffect="none"},isSelected(e){return this.selectedFiles.includes(e)},handleKeyPressed(e){46===e.keyCode&&this.selectedFiles.length>0&&!this.editing&&this.deleteSelectedFiles()},handleAddDirectory(){let e=this;!function(e="",t={}){let n=V(t.target),i=function(e,t){t.style="prompt";let n=S(e,t),i=document.createElement("form"),o=document.createElement("button"),r=document.createElement("input"),s=n.querySelector(`.${N}`),l=t.cancelHandler,a=t.okHandler;return i.classList.add("pentatrion-notify__btns-wrapper"),o.innerHTML=t.okText||"Valider",o.classList.add("btn"),r.classList.add("form-input"),t.placeholder&&r.setAttribute("placeholder",t.placeholder),t.default&&(r.value=t.default),t.inputType&&(r.type=t.inputType),l&&"function"==typeof l&&s.addEventListener("click",l),i.addEventListener("submit",(function(e){e.preventDefault(),a&&"function"==typeof a&&a(r.value)})),a&&"function"==typeof a&&o.addEventListener("click",(function(){a(r.value)})),o.addEventListener("click",n.remove.bind(n)),i.appendChild(r),i.appendChild(o),n.appendChild(i),setTimeout((()=>{r.focus()}),100),n}(e,t);n.appendChild(i),i.classList.add(D)}("Nom du dossier",{okHandler:function(t){t.length>128?B("Le nom du dossier est trop long.",{style:"error"}):e.addDirectory(t)}})},handleClick(e,t){if(t&&2===t.detail)return;-1===this.selectedFiles.indexOf(e)&&this.addFileToSelection(e)},handleDblClick(e){switch(e.type){case"file":this.isModal?this.$emit("confirm"):this.download({files:[e]});break;case"dir":this.setSecondaryDirectoryFromFullDirectory(e.uploadRelativePath)}},handleChangeSecondaryDirectory(e){let t=[];for(let i=0;i<e;i++)t.push(this.secondaryDirectories[i]);let n=t.join("/");""!==n&&(n="/"+n),this.setSecondaryDirectoryFromFullDirectory(this.currentEntryPoint.directory+n)}}),mounted(){this.init(),window.addEventListener("keydown",this.handleKeyPressed)},unmounted(){window.removeEventListener("keydown",this.handleKeyPressed)}},Xe=t.withScopeId("data-v-3a9ccd80");t.pushScopeId("data-v-3a9ccd80");const Ke={class:"action"},We={key:0,class:"fa-order-list"},Ye={key:1,class:"fa-order-icons"},Je=t.createVNode("i",{class:"fa-folder-add"},null,-1),Qe={class:"hierarchy"},Ze={class:"files"};t.popScopeId();const et=Xe(((e,n,i,o,r,s)=>{const l=t.resolveComponent("Uploader"),a=t.resolveComponent("VSelect"),c=t.resolveComponent("Infos");return t.openBlock(),t.createBlock("div",{class:"file-manager",onDragover:n[6]||(n[6]=(...e)=>s.noDragging&&s.noDragging(...e))},[t.createVNode("div",Ke,[t.createVNode("button",{class:"btn btn-outlined",onClick:n[1]||(n[1]=t.withModifiers((e=>s.toggleOrder()),["prevent"]))},["list"===r.presentation?(t.openBlock(),t.createBlock("i",We)):t.createCommentVNode("",!0),"icons"===r.presentation?(t.openBlock(),t.createBlock("i",Ye)):t.createCommentVNode("",!0)]),t.createVNode("button",{class:"btn btn-outlined",disabled:!s.canEdit,onClick:n[2]||(n[2]=(...e)=>s.handleAddDirectory&&s.handleAddDirectory(...e))},[Je],8,["disabled"])]),t.createVNode(l,{class:"dropzone"}),t.createVNode("div",Qe,[t.createVNode(a,{class:"directory-selector","split-button":!0,options:e.entryPoints,modelValue:s.currentEntryPoint,"onUpdate:modelValue":n[3]||(n[3]=e=>s.currentEntryPoint=e),onClick:n[4]||(n[4]=e=>s.handleChangeSecondaryDirectory(0)),placeholder:"Répertoire"},null,8,["options","modelValue"]),(t.openBlock(!0),t.createBlock(t.Fragment,null,t.renderList(e.secondaryDirectories,((e,n)=>(t.openBlock(),t.createBlock("button",{class:"btn btn-outlined",onClick:e=>s.handleChangeSecondaryDirectory(n+1),key:n},t.toDisplayString(e),9,["onClick"])))),128))]),t.createVNode("div",{class:["files-container",{[s.presentationClass]:!0}],onClick:n[5]||(n[5]=(...t)=>e.unselectFiles&&e.unselectFiles(...t))},[t.createVNode("div",Ze,[(t.openBlock(!0),t.createBlock(t.Fragment,null,t.renderList(e.files,(e=>(t.openBlock(),t.createBlock(t.resolveDynamicComponent(s.fileComponent),{key:e.id,class:["file",{selected:s.isSelected(e)}],file:e,onClick:t.withModifiers((t=>s.handleClick(e,t)),["stop"]),onDblclick:t.withModifiers((t=>s.handleDblClick(e)),["stop"])},null,8,["file","class","onClick","onDblclick"])))),128))])],2),t.createVNode(c,{class:"infos",files:e.selectedFiles},null,8,["files"])],32)}));qe.render=et,qe.__scopeId="data-v-3a9ccd80";const tt={components:{FileManager:qe},computed:__assign({},g(["selectedFiles"])),methods:{handleAbort(){let e=new CustomEvent("abortSelect");this.$el.dispatchEvent(e)},handleConfirm(){let e=new CustomEvent("selectFiles",{detail:this.selectedFiles});this.$el.dispatchEvent(e)}}},nt=t.withScopeId("data-v-44e6daa1");t.pushScopeId("data-v-44e6daa1");const it={class:"file-manager-modal"},ot={class:"box"},rt={class:"actions"};t.popScopeId();const st=nt(((e,n,i,o,r,s)=>{const l=t.resolveComponent("FileManager"),a=t.resolveDirective("body-scroll-lock");return t.openBlock(),t.createBlock("div",it,[t.createVNode("div",ot,[t.withDirectives(t.createVNode(l,{class:"file-manager","is-modal":!0,onConfirm:s.handleConfirm},null,8,["onConfirm"]),[[a,!0,"reserve-scroll-bar-gap"]]),t.createVNode("div",rt,[t.createVNode("button",{class:"btn btn-outlined",onClick:n[1]||(n[1]=(...e)=>s.handleAbort&&s.handleAbort(...e))},"Annuler"),t.createVNode("button",{class:"btn",onClick:n[2]||(n[2]=(...e)=>s.handleConfirm&&s.handleConfirm(...e))},"Sélectionner")])]),t.createVNode("div",{class:"bg",onClick:n[3]||(n[3]=(...e)=>s.handleAbort&&s.handleAbort(...e))})])}));tt.render=st,tt.__scopeId="data-v-44e6daa1";var lt=!1;if("undefined"!=typeof window){var at={get passive(){lt=!0}};window.addEventListener("testPassive",null,at),window.removeEventListener("testPassive",null,at)}var ct="undefined"!=typeof window&&window.navigator&&window.navigator.platform&&(/iP(ad|hone|od)/.test(window.navigator.platform)||"MacIntel"===window.navigator.platform&&window.navigator.maxTouchPoints>1),dt=[],ut=!1,pt=-1,ht=void 0,ft=void 0,mt=function(e){return dt.some((function(t){return!(!t.options.allowTouchMove||!t.options.allowTouchMove(e))}))},yt=function(e){var t=e||window.event;return!!mt(t.target)||(t.touches.length>1||(t.preventDefault&&t.preventDefault(),!1))},gt=function(e,t){if(e){if(!dt.some((function(t){return t.targetElement===e}))){var n={targetElement:e,options:t||{}};dt=[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(dt),[n]),ct?(e.ontouchstart=function(e){1===e.targetTouches.length&&(pt=e.targetTouches[0].clientY)},e.ontouchmove=function(t){1===t.targetTouches.length&&function(e,t){var n=e.targetTouches[0].clientY-pt;!mt(e.target)&&(t&&0===t.scrollTop&&n>0||function(e){return!!e&&e.scrollHeight-e.scrollTop<=e.clientHeight}(t)&&n<0?yt(e):e.stopPropagation())}(t,e)},ut||(document.addEventListener("touchmove",yt,lt?{passive:!1}:void 0),ut=!0)):function(e){if(void 0===ft){var t=!!e&&!0===e.reserveScrollBarGap,n=window.innerWidth-document.documentElement.clientWidth;t&&n>0&&(ft=document.body.style.paddingRight,document.body.style.paddingRight=n+"px")}void 0===ht&&(ht=document.body.style.overflow,document.body.style.overflow="hidden")}(t)}}else console.error("disableBodyScroll unsuccessful - targetElement must be provided when calling disableBodyScroll on IOS devices.")},vt=function(e){e?(dt=dt.filter((function(t){return t.targetElement!==e})),ct?(e.ontouchstart=null,e.ontouchmove=null,ut&&0===dt.length&&(document.removeEventListener("touchmove",yt,lt?{passive:!1}:void 0),ut=!1)):dt.length||(void 0!==ft&&(document.body.style.paddingRight=ft,ft=void 0),void 0!==ht&&(document.body.style.overflow=ht,ht=void 0))):console.error("enableBodyScroll unsuccessful - targetElement must be provided when calling enableBodyScroll on IOS devices.")};const bt="reserve-scroll-bar-gap",kt={reserveScrollBarGap:!0},wt={mounted:(e,t)=>{t.arg&&t.arg===bt&&t.value?gt(e,kt):t.value&&gt(e)},updated:(e,t)=>{t.oldValue!==t.value&&(t.arg&&t.arg===bt&&t.value?gt(e,kt):t.value?gt(e):vt(e))},unmounted:e=>{vt(e)}};function _t(e,t){let n=document.createElement("a");n.href=URL.createObjectURL(e),n.download=t,document.body.appendChild(n),n.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window})),document.body.removeChild(n)}function Ct(e){return e<10?"0"+e:e}const Ft="pentatrion-notify";let Nt=[];function St(e="",t={}){let n=function(e=document.body){if(e.dataset.miniNotifier)return Nt[+e.dataset.miniNotifier];let t=function(){let e=document.createElement("DIV");return e.classList.add("pentatrion-notifies"),e}();e===document.body&&t.classList.add("fixed");let n=Nt.push(t);return e.dataset.miniNotifier=n-1,e.appendChild(t),t}(t.target);const i=t.time||5e3;let o=function(e,t){let n=document.createElement("DIV"),i=document.createElement("DIV"),o=t.style,r=document.createElementNS("http://www.w3.org/2000/svg","svg");return r.innerHTML='<path fill="currentColor" d="M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"></path>',r.setAttribute("viewBox","0 0 352 512"),r.setAttribute("height",15),i.append(r),n.classList.add(Ft),o&&n.classList.add(Ft+"--"+o),n.innerHTML=e,i.classList.add("pentatrion-notify__cross"),i.addEventListener("click",n.remove.bind(n)),n.appendChild(i),n}(e,t);window.setTimeout((function(){o.remove()}),i),n.appendChild(o),o.classList.add("pentatrion-notify--bounce-in")}function Dt(e,t={},n=!1){var i;t.body instanceof FormData&&(t.body=(i=t.body,Object.fromEntries(i))),"object"==typeof t.body&&(t.body=JSON.stringify(t.body));let o=new Headers({"Content-Type":"application/json",Accept:"application/json"});return n&&o.append("X-Requested-With","XMLHttpRequest"),Vt(e,t=__assign({headers:o,method:"POST"},t))}function Et(e,t={},n=!1){"object"==typeof t.body&&(t.body=function(e){const t=new FormData;for(let n in e)t.append(n,e[n]);return t}(t.body));let i=new Headers({Accept:"application/json"});return n&&i.append("X-Requested-With","XMLHttpRequest"),Vt(e,t=__assign({headers:i,method:"POST"},t))}async function Vt(e,t={}){let n,i;try{if(n=await fetch(e,t),204===n.status)return null}catch(o){throw new Bt("Erreur serveur.",401)}if(n.headers.has("Content-Type")&&"application/json"!==n.headers.get("Content-Type")){if(!n.ok)throw new Bt("Erreur serveur.",500);return n}try{i=await n.json()}catch(o){throw new Bt("Le contenu renvoyé est illisible.",500)}if(!n.ok){let e=i.err||i.title||i.detail||"Erreur serveur";throw new Bt(e,n.status)}return i}class Bt{constructor(e,t=500){this.title=e,this.status=t}}var Pt=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",jsonFetchOrNotify:async function(e,t={},n=!1){try{return await Dt(e,t,n)}catch(i){throw St(i instanceof Bt?i.title:i,{style:"error",time:5e5}),i}},formFetchOrNotify:async function(e,t={},n=!1){try{return await Et(e,t,n)}catch(i){throw St(i instanceof Bt?i.title:i,{style:"error",time:5e5}),i}},jsonFetch:Dt,formFetch:Et,ApiError:Bt});const{jsonFetchOrNotify:Ot}=Pt;function Tt(e){return t={state:__assign(__assign({},e),{currentEntryPoint:null,secondaryDirectories:[],multiple:!1,directory:null,files:[],selectedFiles:[],editing:!1}),getters:{completeDirectory(e){let t="";if(e.currentEntryPoint)return e.secondaryDirectories.length>0&&(t="/"+e.secondaryDirectories.join("/")),e.currentEntryPoint.directory+t}},mutations:{setFiles(e,t){e.files=t},setDirectory(e,t){e.directory=t},setEntryPoints(e,t){e.entryPoints=t},addFile(e,t){e.files.splice(0,0,t)},addFileByIdToSelection(e,t){let n=e.files.find((e=>e.id===t));n&&(e.multiple?e.selectedFiles.push(n):e.selectedFiles=[n])},addFileToSelection(e,t){e.multiple?e.selectedFiles.push(t):e.selectedFiles=[t]},removeFileToSelection(e,t){let n=e.selectedFiles.indexOf(t);e.selectedFiles.splice(n,1)},selectFileByInode(e,t){let n=e.files.find((e=>e.inode===t));n&&(e.selectedFiles=[n])},unselectFiles(e){e.selectedFiles=[]},setEditing(e,t){e.editing=t},deleteSelectedFiles(e){for(let t of e.selectedFiles){let n=e.files.indexOf(t);-1!==n&&e.files.splice(n,1)}e.selectedFiles=[]},setCurrentEntryPoint(e,t){e.currentEntryPoint=t},setSecondaryDirectory(e,t){e.secondaryDirectories=t}},actions:{async addDirectory({state:e,getters:t,dispatch:n,commit:i},o){Ot(e.endPoints.addDirectory,{method:"POST",body:{filename:o,directory:t.completeDirectory,origin:e.currentEntryPoint.origin}}).then((async({files:e,directory:t})=>{await n("setFiles",e),i("selectFileByInode",t.inode)}))},async updateFilename({commit:e,state:t,dispatch:n},{file:i,filename:o}){Ot(t.endPoints.editFile,{method:"POST",body:{file:i,newFilename:o}}).then((async({files:t})=>{await n("setFiles",t),e("selectFileByInode",i.inode)}))},async download({state:e,getters:t},{files:n=[]}){if(1===n.length&&!n[0].isDir){let t=n[0];return void Ot(`${e.endPoints.showFile}/download/${t.origin}/${t.uploadRelativePath}`,{},!1).then((e=>e.blob())).then((e=>_t(e,t.filename)))}let i=e.directory.filename+"-"+function(e,t=!1){let n=e.getUTCFullYear()+"-"+Ct(e.getUTCMonth()+1)+"-"+Ct(e.getUTCDate());return t?n+"T"+Ct(e.getUTCHours())+"-"+Ct(e.getUTCMinutes()):n}(new Date)+".zip";Ot(e.endPoints.downloadArchive,{method:"POST",body:{files:n}},!1).then((e=>e.blob())).then((e=>{_t(e,i)}))},async deleteSelectedFiles({commit:e,dispatch:t,state:n}){Ot(n.endPoints.deleteFile,{method:"POST",body:n.selectedFiles}).catch((()=>{t("getFiles")})),e("deleteSelectedFiles")},async getFiles({dispatch:e,state:t,getters:n,commit:i}){Ot(t.endPoints.getFiles,{method:"POST",body:{directory:n.completeDirectory,origin:t.currentEntryPoint.origin}}).then((({files:t,directory:n})=>{e("setFiles",t),n&&i("setDirectory",n)}))},async setFiles({commit:e},t){e("unselectFiles"),e("setFiles",t)},async setCurrentEntryPoint({commit:e,dispatch:t},n){e("setCurrentEntryPoint",n),t("setSecondaryDirectoryFromFullDirectory",n.directory)},async setSecondaryDirectoryFromFullDirectory({state:e,commit:t,dispatch:n},i){let o=e.currentEntryPoint.directory;if(0!==i.indexOf(o))return void console.error("répertoire inconnu");let r=i.substring(o.length),s=[];""!==r&&(s=r.substring(1).split("/")),t("setSecondaryDirectory",s),n("getFiles")},async init({dispatch:e,state:t}){e("setCurrentEntryPoint",t.entryPoints[0])}}},new c(t);var t}e.createFileManager=function(e,n){const i=t.createApp(qe);return i.directive("body-scroll-lock",wt),i.use(Tt(e)),i.mount(n),i},e.openFileManager=function(e,n,i){let o=document.createElement("div");function r(){c.$el.removeEventListener("selectFiles",s),c.$el.removeEventListener("abortSelect",l),a.unmount(),c.$el.remove()}function s(e){if(n){let i=[];for(let n=0;n<e.detail.length;n++)i.push(t.toRaw(e.detail[n]));n(t.toRaw(i))}r()}function l(e){i&&i(),r()}document.body.appendChild(o);const a=t.createApp(tt);a.directive("body-scroll-lock",wt),a.use(Tt(e));const c=a.mount(o);c.$el.addEventListener("selectFiles",s),c.$el.addEventListener("abortSelect",l)},Object.defineProperty(e,"__esModule",{value:!0}),e[Symbol.toStringTag]="Module"}));
